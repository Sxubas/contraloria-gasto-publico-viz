(this["webpackJsonpd3-react2"]=this["webpackJsonpd3-react2"]||[]).push([[0],{61:function(t,e,a){t.exports=a(73)},66:function(t,e,a){},67:function(t,e,a){},73:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(29),c=a.n(i),o=(a(66),a(67),a(8)),l=a(9),s=a(12),u=a(10),d=a(11),f=a(75),h=a(76),p=a(77),m=a(78),g=(a(68),"https://gist.githubusercontent.com/whatevercamps/9119e91e7d1f9307c441c057e790c1a5/raw/7fd9814f02d0f435311f50be154f543b625430b6/irregularidades.json"),v=["Cuarta","Especial","NO APLICA","Primera","Quinta","Segunda","Sexta","Tercera","Todas"],b=a(1),x=a(38);function y(t,e){var a={},n=["ciudad"].concat(function(t){var e=[];return console.log("ciudades",t),t.forEach((function(t){return t.irregularidadesEncontradas.forEach((function(t){return e.push(t.name)}))})),Object(x.a)(new Set(e))}(t)),r=t.length,i=n.length,c=t.length*n.length,o=20*r+800,l=20*i+200,s=function(t,e){return[t%e,Math.floor(t/e)]},u=function(t){return t.attr("transform","translate(".concat(400,",0)")).call(b.c(d))},d=b.p().domain(n).range([100,l-100]);return a.pintar=function(){b.t(e).selectAll("svg").remove();var a=b.t(e).append("svg").attr("width",o).attr("height",l);return a.append("g").call(u),a.selectAll("circle").data(b.o(c)).enter().append("circle").attr("r",100).attr("cx",100).attr("cy",100).attr("fill",(function(e){var a=s(e,t.length),r=t[a[0]],i=n[a[1]],c=r.irregularidadesEncontradas.find((function(t){return t.name==i}));return"ciudad"==i?"white":c?c.ingreso?"#F9CA3D":"#B75952":"#9E9FA3"})).call(function(e,a,r,i,c){var o=b.r().domain(b.o(e*a)).range(b.o(400,i-400,(i-800)/e)),l=b.s().domain([0,e*a]).range(b.o(100,c-100,(c-200)/a)),u=b.r().domain(b.o(e*a)).range(b.o(e)),d=b.s().domain([0,e*a]).range(b.o(a)),f=20-2*r,h=20-2*r;function p(e){var a=b.t(e.node().parentNode).append("g").attr("class","grid");return e.each((function(e,p){var m=this,g=a.append("g").attr("class",(function(t){return"cell col-"+u(p)+" row-"+d(p)})).attr("transform",(function(t){var e=document.createElement("span");document.body.appendChild(e),b.t(e).append("svg").attr("width",i).attr("hieght",c).append((function(t){return m}));var a=b.t(m).node().getBBox();document.body.removeChild(e);var n=a.width>f?f/a.width:1,s=a.height>h?h/a.height:1,u=0,d=0;return n>s&&(u=(f-s*a.width)/2),s>n&&(d=(h-n*a.height)/2),s==n&&(u=(f-s*a.width)/2,d=(h-n*a.height)/2),"translate("+(o(p)+r+u)+" "+(l(p)+r+d)+") scale("+b.n([n,s])+")"}));g.append((function(t){return m})),g.append("text").text((function(a){var r=s(e,t.length),i=t[r[0]];return"ciudad"==n[r[1]]?i.name:""})).attr("font-family","sans-serif").attr("font-size","200px").attr("fill","black").attr("transform","translate(175,0) rotate(270)")}))}return p.rows=a,p.cols=e,p.width=i,p.height=c,p.padding=r,p}(r,i,4,o,l)),a.node()},a}var E=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(s.a)(this,Object(u.a)(e).call(this,t))).laref=r.a.createRef(),a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){y(this.props.ciudades||[],this.laref.current).pintar()}},{key:"componentDidUpdate",value:function(){y(this.props.ciudades||[],this.laref.current).pintar()}},{key:"render",value:function(){return r.a.createElement("div",{className:"TableroIrregularidadesClass"},r.a.createElement("div",{ref:this.laref}))}}]),e}(n.Component);function k(t,e){var a={},n={top:30,right:30,bottom:0,left:100},r=600,i=b.q().range([n.left,600-n.right]),c=function(t){return t.attr("class","x-axis").attr("transform","translate(0,".concat(n.top,")")).call(b.d(i).ticks(7.5,"s")).call((function(t){return(t.selection?t.selection():t).select(".domain").remove()}))},o=function(t){return t.attr("class","y-axis").attr("transform","translate(".concat(n.left+.5,",0)")).call((function(t){return t.append("line").attr("stroke","currentColor").attr("y1",n.top).attr("y2",r-n.bottom)}))},l=b.r([!0,!1],["steelblue","#aaa"]),s=27,u=3/s,d=750;return a.update=function(a){var f=b.i(a).sum((function(t){return t.value})).sort((function(t,e){return e.value-t.value})).eachAfter((function(t){return t.index=t.parent?t.parent.index=t.parent.index+1||0:0})),h=1;f.each((function(t){return t.children&&(h=Math.max(h,t.children.length))})),r=h*s+n.top+n.bottom;var p=b.t(t).selectAll("svg").data(["John"]).join("svg").attr("width",600).attr("height",r);function m(t,e,a,r){var c=t.insert("g",r).attr("class","enter").attr("transform","translate(0,".concat(n.top+s*u,")")).attr("text-anchor","end").style("font","10px sans-serif"),o=c.selectAll("g").data(a.children).join("g").attr("cursor",(function(t){return t.children?"pointer":null})).on("click",(function(a){return e(t,a)}));return o.append("text").attr("x",n.left-6).attr("y",s*(1-u)/2).attr("dy",".35em").text((function(t){return t.data.name})),o.append("rect").attr("x",i(0)).attr("width",(function(t){return i(t.value)-i(0)})).attr("height",s*(1-u)),c}function g(t,a){if(a.children&&!b.a(t.node())){t.select(".background").datum(a);var n=t.transition().duration(d),r=n.transition(),o=t.selectAll(".enter").attr("class","exit");o.selectAll("rect").attr("fill-opacity",(function(t){return t===a?0:null})),o.transition(n).attr("fill-opacity",0).remove();var u=m(t,g,a,".y-axis").attr("fill-opacity",0);u.transition(n).attr("fill-opacity",1),u.selectAll("g").attr("transform",v(a.index)).transition(n).attr("transform",x()),i.domain([0,b.l(a.children,(function(t){return t.value}))]),t.selectAll(".x-axis").transition(r).call(c),u.selectAll("g").transition(r).attr("transform",(function(t,e){return"translate(0,".concat(s*e,")")})),u.selectAll("rect").attr("fill",l(!0)).attr("fill-opacity",1).transition(r).attr("fill",(function(t){return l(!!t.children)})).attr("width",(function(t){return i(t.value)-i(0)}))}else e(a)}function v(t){var e=0;return function(a){var n="translate(".concat(i(e)-i(0),",").concat(s*t,")");return e+=a.value,n}}function x(){var t=0;return function(e,a){var n="translate(".concat(i(t)-i(0),",").concat(s*a,")");return t+=e.value,n}}i.domain([0,f.value]),p.append("rect").attr("class","background").attr("fill","none").attr("pointer-events","all").attr("width",600).attr("height",r).attr("cursor","pointer").on("click",(function(t){return function(t,e){if(!e.parent||!t.selectAll(".exit").empty())return;t.select(".background").datum(e.parent);var a=t.transition().duration(d),n=a.transition(),r=t.selectAll(".enter").attr("class","exit");i.domain([0,b.l(e.parent.children,(function(t){return t.value}))]),t.selectAll(".x-axis").transition(a).call(c),r.selectAll("g").transition(a).attr("transform",x()),r.selectAll("g").transition(n).attr("transform",v(e.index)),r.selectAll("rect").transition(a).attr("width",(function(t){return i(t.value)-i(0)})).attr("fill",l(!0)),r.transition(n).attr("fill-opacity",0).remove();var o=m(t,g,e.parent,".exit").attr("fill-opacity",0);o.selectAll("g").attr("transform",(function(t,e){return"translate(0,".concat(s*e,")")})),o.transition(n).attr("fill-opacity",1),o.selectAll("rect").attr("fill",(function(t){return l(!!t.children)})).attr("fill-opacity",(function(t){return t===e?0:null})).transition(n).attr("width",(function(t){return i(t.value)-i(0)})).on("end",(function(t){b.t(this).attr("fill-opacity",1)}))}(p,t)})),p.selectAll("g.x-axis").data((function(t){return t})).join("g").call(c),p.selectAll("g.y-axis").data((function(t){return t})).join("g").call(o),g(p,f)},a}var O=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(s.a)(this,Object(u.a)(e).call(this,t))).laref=r.a.createRef(),a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=k(this.laref.current,this.props.addCityToTable);console.log("bh update",this.props.data),t.update(this.props.data)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"BarchartHierarchyWrapper"},r.a.createElement("div",{ref:this.laref})))}}]),e}(n.Component);var S=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(s.a)(this,Object(u.a)(e).call(this,t))).laref=r.a.createRef(),a.state={hs:null},a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){console.log("pre filter mount",{dataForHist:this.props.dataForHist});var t=this.props.dataForHist.map((function(t){return 1*t.PAGOS}));console.log("pre pintar",t);var e=function(t,e){var a={},n=(e=e,50),r=50,i=50,c=75,o=960-r-c,l=500-n-i,s=b.t(t).append("svg").attr("width",o+r+c).attr("height",l+n+i).append("g").attr("transform","translate("+r+","+n+")"),u=b.m(e),d=b.f(e);e.sort((function(t,e){return t-e}));var f=b.q().domain(b.g(e)).nice().range([0,o]),h={req:{min:5,max:20},got:[]};!function(){for(var t=0,e=h.req.min;e<=h.req.max+1;e++){var a=f.ticks(e).length;a>t&&(t=a,h.got.push(a))}}(),h.def=h.got[Math.round(h.got.length/2)-1],h.cur=h.def;var p=k(e,f,h.def),m=b.q().range([l,0]).domain([0,b.l(p.map((function(t){return t.count})))]),g=b.b(f),v=b.c(m),x=s.append("g").attr("class","zoomButton minus").attr("transform","translate("+o+",55)").classed("active",h.got.indexOf(h.cur)>0).classed("inactive",0==h.got.indexOf(h.cur)).on("click",O),y=s.append("g").attr("class","zoomButton plus").attr("transform","translate("+o+",0)").classed("active",h.got.indexOf(h.cur)<h.got.length-1).classed("inactive",h.got.indexOf(h.cur)==h.got.length-1).on("click",O);y.append("rect").attr("width",50).attr("height",50).attr("fill","green"),y.append("text").attr("x",25).attr("y",50).text("+").attr("text-anchor","middle"),x.append("rect").attr("width",50).attr("height",50).attr("fill","red"),x.append("text").attr("x",25).attr("y",50).attr("dy",-2).text("-").attr("text-anchor","middle");var E=1e3;function k(t,e,a){var n=[];return console.log("bindata",{s:e.ticks(a),t:a}),e.ticks(a).forEach((function(t,e){e<f.ticks(a).length-1&&n.push({bin:e,min:t,max:f.ticks(a)[e+1]})})),n.forEach((function(e){e.count=t.filter((function(t){return t>=e.min&&t<e.max})).length})),n}function O(){if(this){if(b.t(this).classed("inactive"))return 0;b.t(this).classed("plus")?h.cur=h.got[h.got.indexOf(h.cur)+1]:h.cur=h.got[h.got.indexOf(h.cur)-1]}x.classed("active",h.got.indexOf(h.cur)>0).classed("inactive",0==h.got.indexOf(h.cur)),y.classed("active",h.got.indexOf(h.cur)<h.got.length-1).classed("inactive",h.got.indexOf(h.cur)==h.got.length-1),s.select(".axis.x").transition().duration(E).call(g.ticks(h.cur));var t=k(e,f,h.cur);m.domain([0,b.l(t.map((function(t){return t.count})))]),s.select(".axis.y").transition().duration(E).call(v),s.selectAll(".bar").transition().duration(E).attr("height",(function(t){return l-m(0)})).attr("y",(function(t){return m(0)})).transition().remove(),s.selectAll(null).data(t).enter().append("rect").attr("class","bar").attr("width",f(t[0].max)-f(t[0].min)-2).attr("height",(function(t){return l-m(0)})).attr("y",(function(t){return m(0)})).attr("x",(function(t){return f(t.min)})).attr("fill",(function(t){return u+1.96*d<=t.max?"red":"steelblue"})).transition().duration(E).attr("height",(function(t){return l-m(t.count)})).attr("y",(function(t){return m(t.count)}))}return a.update=function(t){console.log("update",t),t&&t.length>0&&t!=e&&(e=t,O())},a.pintar=function(){return s.selectAll(".bar").data(p).enter().append("rect").attr("class","bar").attr("width",f(p[0].max)-f(p[0].min)-2).attr("height",(function(t){return l-m(t.count)})).attr("x",(function(t){return f(t.min)})).attr("y",(function(t){return m(t.count)})).attr("fill",(function(t){return u+1.96*d<=t.max?"red":"steelblue"})),s.append("g").attr("class","axis x").attr("transform","translate(0,"+l+")").call(g.tickFormat(b.h("$.2s"))),s.append("g").attr("class","axis y").call(v.tickFormat(b.h(".2s"))),s.node()},a}(this.laref.current,t);e.pintar(),this.setState({hs:e})}},{key:"componentDidUpdate",value:function(t,e){if(console.log("pre filter update",{dataForHist:this.props.dataForHist}),t.dataForHist!=this.props.dataForHist){var a=this.state.hs,n=this.props.dataForHist.map((function(t){return 1*t.PAGOS}));console.log("pre update",n),a.update(n)}}},{key:"render",value:function(){return r.a.createElement("div",{className:"Medias"},r.a.createElement("div",{ref:this.laref}))}}]),e}(n.Component),w=function(t){function e(){var t,a;Object(o.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(s.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(r)))).state={data:null,ciudades:[],catSelected:v[0],dataCategoria:null,rubros:[],dataForHist:null,rubroSelected:null},a.addCityToTable=function(t){console.log("datos tabla",{ciudades:a.state.ciudades,city:t});var e=a.state.ciudades;e.push(t.data),console.log("add node",e),a.setState({ciudades:e})},a}return Object(d.a)(e,t),Object(l.a)(e,[{key:"componentWillMount",value:function(){var t=this;b.j(g).then((function(e){t.setState({data:e})})),b.e("./"+this.state.catSelected+".csv").then((function(e){t.setState({dataCategoria:e});var a=b.k(e,(function(t){return t.NOM_DEST})).keys();t.setState({rubros:a,rubroSelected:a[0]});var n=e.filter((function(e){return e.NOM_DEST==t.state.rubroSelected}));t.setState({dataForHist:n})}))}},{key:"componentDidUpdate",value:function(t,e){var a=this;if(this.state.catSelected!=e.catSelected&&b.e("./"+this.state.catSelected+".csv").then((function(t){a.setState({dataCategoria:t});var e=b.k(t,(function(t){return t.NOM_DEST})).keys();a.setState({rubros:e,rubroSelected:e[0]});var n=t.filter((function(t){return t.NOM_DEST==a.state.rubroSelected}));a.setState({dataForHist:n})})),this.state.rubroSelected!=e.rubroSelected){var n=this.state.dataCategoria.filter((function(t){return t.NOM_DEST==a.state.rubroSelected}));this.setState({dataForHist:n})}}},{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement(f.a,null,r.a.createElement(h.a,null,r.a.createElement(p.a,{lg:12},r.a.createElement(m.a,{style:{display:"inline",margin:"5px"}},r.a.createElement(m.a.Toggle,{variant:"secondary",id:"dropdown-basic"},"Categoria ",this.state.catSelected),r.a.createElement(m.a.Menu,null,v.map((function(e,a){return r.a.createElement(m.a.Item,{key:a,onClick:function(){return t.setState({catSelected:e})}},e)})))),this.state.rubros&&this.state.rubros.length>0?r.a.createElement(m.a,{style:{display:"inline",margin:"5px"}},r.a.createElement(m.a.Toggle,{variant:"secondary",id:"dropdown-basic"},"Rubro ",this.state.rubroSelected),r.a.createElement(m.a.Menu,null,this.state.rubros.map((function(e,a){return r.a.createElement(m.a.Item,{key:a,onClick:function(){return t.setState({rubroSelected:e})}},e)})))):r.a.createElement(r.a.Fragment,null))),this.state.dataForHist?r.a.createElement(h.a,null,r.a.createElement(p.a,{lg:12},r.a.createElement(S,{dataForHist:this.state.dataForHist}))):r.a.createElement(r.a.Fragment,null),r.a.createElement(h.a,null,r.a.createElement(p.a,{lg:6},this.state.data?r.a.createElement(O,{data:this.state.data,addCityToTable:this.addCityToTable}):r.a.createElement(r.a.Fragment,null)),r.a.createElement(p.a,{lg:6},this.state.ciudades&&this.state.ciudades.length>0?r.a.createElement(E,{ciudades:this.state.ciudades}):r.a.createElement(r.a.Fragment,null)))))}}]),e}(n.Component);var A=function(){return r.a.createElement("div",{className:"App",style:{margin:"20px"}},r.a.createElement(w,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[61,1,2]]]);
//# sourceMappingURL=main.1f9f4984.chunk.js.map